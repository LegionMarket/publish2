!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){"use strict";function t(i,r){this.$element=e(i),this.options=e.extend({},t.DEFAULTS,e.isPlainObject(r)&&r),this.init()}var i=window.location,r=e(document),n="qor.filter",o="enable."+n,a="disable."+n,s="click."+n,l=".qor-filter__scheduled-time",c="[data-search-param]",h=".qor-filter__dropdown",d=".qor-filter-toggle",u="publish_draft_content",f="publish_scheduled_time",p='[name="QorResource.PublishReady"]';return t.prototype={constructor:t,init:function(){this.bind();var t=this.$element;this.$scheduleTime=t.find(l),this.$searchButton=t.find(this.options.button),this.$trigger=t.find(this.options.trigger),this.publishReadyOff=e("#qor-publishready__off").data().label,this.initActionTemplate()},bind:function(){var e=this.options;this.$element.on(s,e.trigger,this.show.bind(this)).on(s,e.clear,this.clear.bind(this)).on(s,e.button,this.search.bind(this)),r.on(s,this.close)},unbind:function(){var e=this.options;this.$element.off(s,e.trigger,this.show.bind(this)).off(s,e.clear,this.clear.bind(this)).off(s,e.button,this.search.bind(this))},initActionTemplate:function(){var t=this.getUrlParameter(f),i=this.getUrlParameter(u),r=this.$trigger,n=r.find(".qor-selector-label"),o=r.find(".qor-publishready-label"),a=e("#qor-publishready__off");""==i?e(p).prop("checked",!1):"true"===i&&(a.prop("checked",!0),o.html(this.publishReadyOff).parent().show(),o.before('<i class="material-icons qor-selector-clear" data-type="publishready">clear</i>')),""!=t&&(this.$scheduleTime.val(t),n.parent().show(),n.html(t),n.before('<i class="material-icons qor-selector-clear">clear</i>'))},show:function(){this.$element.find(h).toggle()},close:function(t){var i=e(t.target),r=e(h),n=r.is(":visible"),o=i.closest(h).size(),a=i.closest(d).size(),s=i.closest(".qor-modal").size();n&&(o||a||s)||r.hide()},clear:function(t){var i=e(t.target),r=this.$trigger,n=r.find(".qor-selector-label"),o=r.find(".qor-publishready-label");return i.data().type?(o.html("").parent().hide(),e(p).prop("checked",!1)):(n.parent().hide(),this.$scheduleTime.val("")),i.remove(),this.$searchButton.click(),!1},getUrlParameter:function(e){var t=i.search;e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=r.exec(t);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))},updateQueryStringParameter:function(e,t,r){var n=r||i.href,o=String(e).replace(/[\\^$*+?.()|[\]{}]/g,"\\$&"),a=new RegExp("([?&])"+o+"=.*?(&|$)","i"),s=-1!==n.indexOf("?")?"&":"?";return n.match(a)?n.replace(a,"$1"+e+"="+t+"$2"):n+s+e+"="+t},search:function(){var t,i=this.$element.find(c),r=this;i.size()&&(i.each(function(){var i=e(this),n=i.data().searchParam,o=i.find(p).is(":checked"),a=i.val();n==u&&(a=o?"true":""),t=r.updateQueryStringParameter(n,a,t)}),window.location.href=t)},destroy:function(){this.unbind(),this.$element.removeData(n)}},t.DEFAULTS={trigger:!1,button:!1,clear:!1},t.plugin=function(i){return this.each(function(){var r,o=e(this),a=o.data(n);if(!a){if(/destroy/.test(i))return;o.data(n,a=new t(this,i))}"string"==typeof i&&e.isFunction(r=a[i])&&r.apply(a)})},e(function(){var i='[data-toggle="qor.filter.time"]',r={trigger:"a.qor-filter-toggle",button:".qor-filter__button-search",clear:".qor-selector-clear"};e(document).on(a,function(r){t.plugin.call(e(i,r.target),"destroy")}).on(o,function(n){t.plugin.call(e(i,n.target),r)}).triggerHandler(o)}),t});